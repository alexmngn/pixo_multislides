/*
 * pixo.multislides.js
 * version 1.0b1
 * 
 * Copyright 2013, Alexis Mangin
 * http://www.pixostudio.net/
 * Github: https://github.com/pixostudio/
 * 
 * Released under the MIT License
 * http://opensource.org/licenses/MIT
 */

(function(a){a.pixo_multislides=function(c,d){var f=this,d=d;f.$el=a(c);var g={plugin:"pixo_multislides",pages:{array:[],current:0},slides:{array:[],displayed:0},autoPlay:!1,autoPlayInterval:null,swipe:!1,isAnim:!1},h=function(){d=a.extend(!0,{},b,d),r("Pixo Multislides: init()"),f.$el.hasClass(g.plugin)||f.$el.addClass(g.plugin),f.$el.find("> ul > li").each(function(){g.slides.array.push(a(this))}),l(),j(),k(),i(),n(),r("----------"),r("Slides:"),r(g.slides.array),r("Pages:"),r(g.pages.array),r("----------")},i=function(){r("Pixo Multislides: initEvents()"),a(window).on("resize",n),f.$el.on("click","a.multislides-nav-prev",function(a){return a.preventDefault(),f.goto(g.pages.current-1),!1}),f.$el.on("click","a.multislides-nav-next",function(a){return a.preventDefault(),f.goto(g.pages.current+1),!1})},j=function(){r("Pixo Multislides: initNavigation()"),a('<a href="#" class="multislides-nav-prev"></a>').appendTo(f.$el),a('<a href="#" class="multislides-nav-next"></a>').appendTo(f.$el)},k=function(){if(r("Pixo Multislides: initSwipe()"),a.fn.swipe){var b=null,c=null,d=null;f.$el.swipe({swipeStatus:function(a,e,h,i){if("move"==e){var l=null;"left"==h&&(l=o(g.pages.current+1),g.pages.array[g.pages.current].css("left","-"+i+"px"),g.pages.array[l].css("display","block").css("left",f.$el.width()-i+"px")),"right"==h&&(l=o(g.pages.current-1),g.pages.array[g.pages.current].css("left",i+"px"),g.pages.array[l].css("display","block").css("left","-"+(f.$el.width()-i)+"px")),b!=h&&(g.pages.array[g.pages.current].css("left","0px"),n()),b=h}if("end"==e){var m=null;return c>f.$el.width()/5&&c-d>f.$el.width()/25&&(m=150),"left"==h&&f.goto(g.pages.current+1,m),"right"==h&&f.goto(g.pages.current-1,m),void 0}d=c,c=i},allowPageScroll:"vertical"}),f.$el.on("dragstart","a",function(a){event.preventDefault();var b=jQuery.Event("mousedown");return b.pageX=a.originalEvent.pageX,b.pageY=a.originalEvent.pageY,f.$el.trigger(b),!1}),f.$el.on("mouseleave",function(){f.$el.trigger("mouseup")}),g.swipe=!0}},l=function(){r("Pixo Multislides: checkWrap()"),f.$el.is("ul")&&(f.$el=f.$el.wrap("div."+g.plugin))},m=function(){return r("Pixo Multislides: getDevice()"),a(window).width()<=d.size.mobile?"mobile":a(window).width()>d.size.mobile&&a(window).width()<=d.size.tablet?"tablet":"desktop"},n=function(){r("Pixo Multislides: resize()"),q();var a=Math.floor(f.$el.width()/d.slides.minWidth);a>d.slides.maxDisplayed&&(a=d.slides.maxDisplayed),a!=g.slides.displayed&&p(a);for(key in g.pages.array)if(key!=g.pages.current){var b=g.pages.current>key?"-":"+";g.pages.array[key].css("left",b+f.$el.width()+"px")}var c=m();f.autoPlay(d.pages[c].autoPlay.enable),f.navigation(d.pages[c].navigation.enable),f.swipe(d.pages[c].swipe.enable)},o=function(a){return r("Pixo Multislides: checkPage("+a+")"),0>a?a=g.pages.array.length-1:(a>g.pages.array.length-1||"number"!=typeof a)&&(a=0),a},p=function(b){r("Pixo Multislides: generate("+b+")"),f.$el.find("> ul").remove();var c=Math.ceil(g.slides.array.length/b);g.pages.current>=c&&(g.pages.current=c-1),g.pages.array=[];var d=a("<ul></ul>");for(var e in g.slides.array)e=parseInt(e),g.slides.array[e].width(Math.round(100/b)-2+"%"),d.append(g.slides.array[e]),0==e||0!==(e+1)%b&&e+1!==g.slides.array.length||(d.css("left","0px").css("display","block").appendTo(f.$el),g.pages.array.push(d),g.pages.array.length-1!=g.pages.current&&g.pages.array[g.pages.array.length-1].css("display","none"),e!=g.slides.array.length-1&&(d=a("<ul></ul>")));g.slides.displayed=b},q=function(){r("Pixo Multislides: stopGoto()"),f.$el.find("> ul").css("display","none").stop(),g.pages.current=o(g.pages.current),void 0!=g.pages.array[g.pages.current]&&g.pages.array[g.pages.current].css("display","block").css("left","0px"),g.isAnim=!1},r=function(a){1==d.debug&&console.log(a)};f.autoPlay=function(a){if(r("Pixo Multislides: autoPlay("+a+")"),1==a&&0==g.autoPlay){var b=d.pages[f.getDevice()].autoPlay.delay<d.pages.speed?d.pages.speed+50:d.pages[f.getDevice()].autoPlay.delay;g.autoPlayInterval=setInterval(function(){f.goto(g.pages.current+1)},b)}else 0==a&&1==g.autoPlay&&(clearInterval(g.autoPlayInterval),g.isAnim=!1);g.autoPlay=a},f.navigation=function(a){r("Pixo Multislides: navigation("+a+")"),1==a?f.$el.find('a[class*="multislides-nav"]').css("display","block"):0==a&&f.$el.find('a[class*="multislides-nav"]').css("display","none")},f.swipe=function(a){r("Pixo Multislides: swipe("+a+")"),1==g.swipe?1==a?f.$el.swipe("enable"):0==a&&f.$el.swipe("disable"):1==a&&r("Pixo Multislides: swipe("+a+"): Swipe library is not loaded")},f.goto=function(a,b){var c=g.pages.current>a?"-":"+";if(a=o(a),r("Pixo Multislides: goto("+a+", "+b+")"),!g.isAnim&&a!=g.pages.current){g.isAnim=!0;var e=void 0!=b&&null!=b?b:Math.abs(parseInt(g.pages.array[a].css("left")))*d.pages.speed/f.$el.width();Math.abs(parseInt(g.pages.array[a].css("left")))>=f.$el.width()&&g.pages.array[a].css("left",c+f.$el.width()+"px"),g.pages.array[a].css("display","block").stop().animate({left:"0px"},e),g.pages.array[g.pages.current].stop().animate({left:("-"==c?"":"-")+f.$el.width()+"px"},e,function(){0==g.isAnim?q():(g.pages.array[g.pages.current].css("display","none"),g.pages.current=a,g.isAnim=!1)})}},h()};var b={debug:!1,pages:{desktop:{autoPlay:{enable:!1,delay:5e3},navigation:{enable:!0},swipe:{enable:!0}},tablet:{autoPlay:{enable:!1,delay:5e3},navigation:{enable:!0},swipe:{enable:!0}},mobile:{autoPlay:{enable:!1,delay:5e3},navigation:{enable:!1},swipe:{enable:!0}},speed:500},slides:{minWidth:230,maxDisplayed:4},size:{tablet:1024,mobile:480}};a.fn.pixo_multislides=function(b,c){return this.each(function(){if(null!=a(this).data("multislides")&&"string"==typeof b){var d=a(this).data("multislides");d.pixo[b]&&d.pixo[b].apply(this,c)}else a(this).data("multislides",new a.pixo_multislides(this,b))})}})(jQuery);